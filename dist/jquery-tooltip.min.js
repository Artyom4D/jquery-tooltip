/*! jQuery tooltip - v0.1.0 - 2013-10-09
* https://github.com/amazingSurge/jquery-tooltip
* Copyright (c) 2013 amazingSurge; Licensed GPL */
(function(t){"use strict";function e(t,e,n,i,o,s){var a,r,c,h=0,l=0;switch(s?(a=t,r=0,c=0):(a=t.offset(),r=t.outerWidth(),c=t.outerHeight()),e){case"n":h=a.left+r/2-n/2,l=a.top-i-o;break;case"e":h=a.left+r+o,l=a.top+c/2-i/2;break;case"s":h=a.left+r/2-n/2,l=a.top+c+o;break;case"w":h=a.left-n-o,l=a.top+c/2-i/2;break;case"nw":h=a.left-n+20,l=a.top-i-o;break;case"ne":h=a.left+r-20,l=a.top-i-o;break;case"sw":h=a.left-n+20,l=a.top+c+o;break;case"se":h=a.left+r-20,l=a.top+c+o}return{left:Math.round(h),top:Math.round(l)}}function n(t,e){var n,i,o=s.scrollLeft(),a=s.scrollTop(),r=t.offset(),c=t.outerWidth(),h=t.outerHeight(),l=s.width(),p=s.height(),u=[];return e?(n=e.outerWidth(),i=e.outerHeight()):(n=100,i=50),a+i>r.top&&u.push("n"),r.top+h+i>a+p&&u.push("s"),o+n>r.left&&u.push("w"),r.left+c+n>o+l&&u.push("e"),u}function i(){var t=document.body||document.documentElement,e=t.style,n="transition";if("string"==typeof e[n])return!0;o=["Moz","Webkit","Khtml","O","ms"],n=n.charAt(0).toUpperCase()+n.substr(1);for(var i=0;o.length>i;i++)if("string"==typeof e[o[i]+n])return!0;return!1}var o,s=t(window),a=!1,r=[],c={n:["s"],s:["n"],w:["e"],e:["w"],nw:["sw","ne"],ne:["se","nw"],sw:["se","nw"],se:["ne","sw"]},h=!0;i()||(h=!1);var l=t.tooltip=function(e,n){var i={};this.$elem=t(e),t.each(this.$elem.data(),function(t,e){/^tooltip/i.test(t)&&(i[t.toLowerCase().replace(/^tooltip/i,"")]=e)}),this.options=t.extend({},l.defaults,n,i),this.namespace=this.options.namespace,this.$elem.attr("title")&&(this.options.title=this.$elem.attr("title"),this.$elem.removeAttr("title")),this.content=null,this.target=this.options.target||this.$elem,this.isOpen=null,this.enabled=!0,this.tolerance=null,this.onlyOne=this.options.onlyOne||!1,this.init()};l.prototype={constructor:l,init:function(){var n=this.options,i=this;n.tpl=this.parseTpl(n.tpl),this.$container=t(n.tpl.container),this.$loading=t(n.tpl.loading),this.$arrow=t(n.tpl.arrow),this.$close=t(n.tpl.close),this.$content=t(n.tpl.content),"hover"===n.trigger&&(this.target.on("mouseenter.tooltip",function(){return i.isOpen===!0?(clearTimeout(this.tolerance),void 0):(t.proxy(i.show,i)(),void 0)}),n.interactive===!0?this.target.on("mouseleave.tooltip",function(){var e=!1;i.$container.on("mouseenter",function(){e=!0}),i.$container.on("mouseleave",function(){e=!1}),clearTimeout(this.tolerance),this.tolerance=setTimeout(function(){e===!0?i.$container.on("mouseleave.tooltip",t.proxy(i.hide,i)):t.proxy(i.hide,i)()},i.options.interactiveDelay)}):this.target.on("mouseleave.tooltip",t.proxy(i.hide,i)),this.options.mouseTrace===!0&&this.target.on("mousemove.tooltip",function(t){var n,o={},s=t.pageX,a=t.pageY;o={top:a,left:s},n=e(o,i.options.position,i.width,i.height,i.options.popSpace,!0),i.$container.css({display:"block",top:n.top,left:n.left})})),"click"===n.trigger&&this.target.on("click.tooltip",function(){i.isOpen===!0?t.proxy(i.hide,i)():t.proxy(i.show,i)()}),r.push(this)},load:function(){var n=this,i=this.options;i.ajax===!0?t.ajax(t.extend({},i.ajaxSettings,{url:i.title,error:function(){throw Error("ajax error")},success:function(t,o){if("success"===o){n.content=t,n.$container.css({display:"none"}),n.$content.empty().append(n.content);var s=e(n.target,i.position,n.$container.outerWidth(),n.$container.outerHeight(),i.popSpace);n.$container.css({display:"block",top:s.top,left:s.left})}}})):this.content=i.inline===!0?-1!==i.content.indexOf("+")?this.$elem.next().css({display:"block"}):t(i.content).css({display:"block"}):i.title},parseTpl:function(e){var n={},i=this;return t.each(e,function(t,e){n[t]=e.replace("{{namespace}}",i.namespace)}),n},showLoading:function(){this.$content.empty(),this.$loading.css({display:"block"})},hideLoading:function(){this.$loading.css({display:"none"})},show:function(){var i,o=this.options,s=this.namespace+"-"+o.position,a=this;if(this.enabled!==!1){if(this.onlyOne===!0&&t.each(r,function(t,e){e!==a&&e.isOpen===!0&&e.hide()}),o.closeBtn===!0&&this.$container.append(this.$close),this.$container.append(this.$arrow).append(this.$content),this.$elem.addClass(this.namespace+"_active"),null===this.content&&this.load(),null===this.content?this.$content.append(this.$loading):this.$content.empty().append(this.content),null!==o.skin&&this.$container.addClass(this.namespace+"_"+o.skin),this.$container.css({display:"none",top:0,left:0,position:"absolute",zIndex:99990}).appendTo(t("body")),this.width=this.$container.outerWidth(),this.height=this.$container.outerHeight(),o.mouseTrace===!1){if(o.autoPosition===!0){var h,l=[],p=[];p=o.ajax===!0?n(t(this.target)):n(t(this.target),this.$container),p.length>0?(t.each(o.position.split(""),function(e,n){-1!==t.inArray(n,p)?l.push(c[n]):l.push(n)}),h=l.join("")):h=o.position,s=this.namespace+"-"+h,i=e(this.target,h,this.width,this.height,this.options.popSpace)}else i=e(this.target,o.position,this.width,this.height,this.options.popSpace);this.$container.css({display:"block",top:i.top,left:i.left})}else this.$container.addClass("pointer-events-none");return this.$container.addClass(s),"function"===o.onShow&&o.onShow(this.$elem),this.$container.trigger("show"),this.isOpen=!0,this}},hide:function(){this.$container.off(".tooltip"),this.$container.trigger("hide"),this.$elem.removeClass(this.namespace+"_active"),this.$container.remove(),"function"===this.options.onHide&&this.options.onHide(this.$elem),this.isOpen=!1,a=!1},setContent:function(t){this.content=t},enable:function(){return this.enabled=!0,this.container.addClass(this.namespace+"-enabled"),this},disable:function(){return this.enabled=!1,this.container.removeClass(this.namespace+"-enabled"),this},destroy:function(){this.target.off(".tooltip")}},l.defaults={namespace:"tooltip",skin:null,target:null,trigger:"hover",interactive:!1,interactiveDelay:500,mouseTrace:!1,closeBtn:!1,popSpace:10,position:"n",autoPosition:!0,delay:0,effect:"fade",duration:200,inline:!1,content:null,ajax:!1,ajaxSettings:{dataType:"html",headers:{tooltip:!0}},onShow:null,onHide:null,onUpdate:null,tpl:{container:'<div class="{{namespace}}-container"></div>',loading:'<span class="{{namespace}}-loading"></span>',content:'<div class="{{namespace}}-content"></div>',arrow:'<span class="{{namespace}}-arrow"></span>',close:'<a class="{{namespace}}-close"></a>'}},t.fn.tooltip=function(e){if("string"==typeof e){var n=e,i=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0;return this.each(function(){var e=t.data(this,"tooltip");"function"==typeof e[n]&&e[n].apply(e,i)})}return this.each(function(){t.data(this,"tooltip")||t.data(this,"tooltip",new l(this,e))})}})(jQuery);