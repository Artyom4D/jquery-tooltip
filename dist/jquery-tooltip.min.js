/*! jQuery tooltip - v0.1.0 - 2013-10-09
* https://github.com/amazingSurge/jquery-tooltip
* Copyright (c) 2013 amazingSurge; Licensed GPL */
(function(t){"use strict";function e(t,e,i,n,o,s){var a,r,l,c=0,h=0;switch(s?(a=t,r=0,l=0):(a=t.offset(),r=t.outerWidth(),l=t.outerHeight()),e){case"n":c=a.left+r/2-i/2,h=a.top-n-o;break;case"e":c=a.left+r+o,h=a.top+l/2-n/2;break;case"s":c=a.left+r/2-i/2,h=a.top+l+o;break;case"w":c=a.left-i-o,h=a.top+l/2-n/2;break;case"nw":c=a.left-i+20,h=a.top-n-o;break;case"ne":c=a.left+r-20,h=a.top-n-o;break;case"sw":c=a.left-i+20,h=a.top+l+o;break;case"se":c=a.left+r-20,h=a.top+l+o}return{left:Math.round(c),top:Math.round(h)}}function i(t,e){var i,n,o=s.scrollLeft(),a=s.scrollTop(),r=t.offset(),l=t.outerWidth(),c=t.outerHeight(),h=s.width(),p=s.height(),u=[];return e?(i=e.outerWidth(),n=e.outerHeight()):(i=100,n=50),a+n>r.top&&u.push("n"),r.top+c+n>a+p&&u.push("s"),o+i>r.left&&u.push("w"),r.left+l+i>o+h&&u.push("e"),u}function n(){var t=document.body||document.documentElement,e=t.style,i="transition";if("string"==typeof e[i])return!0;o=["Moz","Webkit","Khtml","O","ms"],i=i.charAt(0).toUpperCase()+i.substr(1);for(var n=0;o.length>n;n++)if("string"==typeof e[o[n]+i])return!0;return!1}var o,s=t(window),a=!1,r=[],l={n:["s"],s:["n"],w:["e"],e:["w"],nw:["sw","ne"],ne:["se","nw"],sw:["se","nw"],se:["ne","sw"]},c=!0;n()||(c=!1);var h=t.tooltip=function(e,i){var n={};this.$elem=t(e),t.each(this.$elem.data(),function(t,e){/^tooltip/i.test(t)&&(n[t.toLowerCase().replace(/^tooltip/i,"")]=e)}),this.options=t.extend({},h.defaults,i,n),this.namespace=this.options.namespace,this.$elem.attr("title")&&(this.options.title=this.$elem.attr("title"),this.$elem.removeAttr("title")),this.content=null,this.target=this.options.target||this.$elem,this.isOpen=null,this.enabled=!0,this.tolerance=null,this.onlyOne=this.options.onlyOne||!1,this.init()};h.prototype={constructor:h,init:function(){var i=this.options,n=this;i.tpl=this.parseTpl(i.tpl),this.$container=t(i.tpl.container),this.$loading=t(i.tpl.loading),this.$arrow=t(i.tpl.arrow),this.$close=t(i.tpl.close),this.$content=t(i.tpl.content),"hover"===i.trigger&&(this.target.on("mouseenter.tooltip",function(){return n.isOpen===!0?(clearTimeout(this.tolerance),void 0):(t.proxy(n.show,n)(),void 0)}),i.interactive===!0?this.target.on("mouseleave.tooltip",function(){var e=!1;n.$container.on("mouseenter",function(){e=!0}),n.$container.on("mouseleave",function(){e=!1}),clearTimeout(this.tolerance),this.tolerance=setTimeout(function(){e===!0?n.$container.on("mouseleave.tooltip",t.proxy(n.hide,n)):t.proxy(n.hide,n)()},n.options.interactiveDelay)}):this.target.on("mouseleave.tooltip",t.proxy(n.hide,n)),this.options.mouseTrace===!0&&this.target.on("mousemove.tooltip",function(t){var i,o={},s=t.pageX,a=t.pageY;o={top:a,left:s},i=e(o,n.options.position,n.width,n.height,n.options.popSpace,!0),n.$container.css({display:"block",top:i.top,left:i.left})})),"click"===i.trigger&&this.target.on("click.tooltip",function(){n.isOpen===!0?t.proxy(n.hide,n)():t.proxy(n.show,n)()}),r.push(this)},load:function(){var i=this,n=this.options;n.ajax===!0?t.ajax(t.extend({},n.ajaxSettings,{url:n.title,error:function(){throw Error("ajax error")},success:function(t,o){if("success"===o){i.content=t,i.$container.css({display:"none"}),i.$content.empty().append(i.content);var s=e(i.target,n.position,i.$container.outerWidth(),i.$container.outerHeight(),n.popSpace);i.$container.css({display:"block",top:s.top,left:s.left})}}})):this.content=n.inline===!0?-1!==n.title.indexOf("+")?this.$elem.next().css({display:"block"}):t(n.title).css({display:"block"}):n.title},parseTpl:function(e){var i={},n=this;return t.each(e,function(t,e){i[t]=e.replace("{{namespace}}",n.namespace)}),i},showLoading:function(){this.$content.empty(),this.$loading.css({display:"block"})},hideLoading:function(){this.$loading.css({display:"none"})},show:function(){var n,o=this.options,s=this.namespace+"-"+o.position,a=this;if(this.enabled!==!1){if(this.onlyOne===!0&&t.each(r,function(t,e){e!==a&&e.isOpen===!0&&e.hide()}),o.closeBtn===!0&&this.$container.append(this.$close),this.$container.append(this.$arrow).append(this.$content),this.$elem.addClass(this.namespace+"_active"),null===this.content&&this.load(),null===this.content?this.$content.append(this.$loading):this.$content.empty().append(this.content),null!==o.skin&&this.$container.addClass(this.namespace+"_"+o.skin),this.$container.css({display:"none",top:0,left:0,position:"absolute",zIndex:99990}).appendTo(t("body")),this.width=this.$container.outerWidth(),this.height=this.$container.outerHeight(),o.mouseTrace===!1){if(o.autoPosition===!0){var c,h=[],p=[];p=o.ajax===!0?i(t(this.target)):i(t(this.target),this.$container),p.length>0?(t.each(o.position.split(""),function(e,i){-1!==t.inArray(i,p)?h.push(l[i]):h.push(i)}),c=h.join("")):c=o.position,s=this.namespace+"-"+c,n=e(this.target,c,this.width,this.height,this.options.popSpace)}else n=e(this.target,o.position,this.width,this.height,this.options.popSpace);this.$container.css({display:"block",top:n.top,left:n.left})}else this.$container.addClass("pointer-events-none");return this.$container.addClass(s),"function"===o.onShow&&o.onShow(this.$elem),this.$container.trigger("show"),this.isOpen=!0,this}},hide:function(){this.$container.off(".tooltip"),this.$container.trigger("hide"),this.$elem.removeClass(this.namespace+"_active"),this.$container.remove(),"function"===this.options.onHide&&this.options.onHide(this.$elem),this.isOpen=!1,a=!1},setContent:function(t){this.content=t},enable:function(){return this.enabled=!0,this.container.addClass(this.namespace+"-enabled"),this},disable:function(){return this.enabled=!1,this.container.removeClass(this.namespace+"-enabled"),this},destroy:function(){this.target.off(".tooltip")}},h.defaults={namespace:"tooltip",skin:null,target:null,trigger:"hover",interactive:!1,interactiveDelay:500,mouseTrace:!1,closeBtn:!1,popSpace:10,position:"n",autoPosition:!0,delay:0,effect:"fade",duration:200,inline:!1,content:null,ajax:!1,ajaxSettings:{dataType:"html",headers:{tooltip:!0}},onShow:null,onHide:null,onUpdate:null,tpl:{container:'<div class="{{namespace}}-container"></div>',loading:'<span class="{{namespace}}-loading"></span>',content:'<div class="{{namespace}}-content"></div>',arrow:'<span class="{{namespace}}-arrow"></span>',close:'<a class="{{namespace}}-close"></a>'}},t.fn.tooltip=function(e){if("string"==typeof e){var i=e,n=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0;return this.each(function(){var e=t.data(this,"tooltip");"function"==typeof e[i]&&e[i].apply(e,n)})}return this.each(function(){t.data(this,"tooltip")||t.data(this,"tooltip",new h(this,e))})}})(jQuery);